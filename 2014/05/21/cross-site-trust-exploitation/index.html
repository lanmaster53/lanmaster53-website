<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>lanmaster53.com</title>
        <meta name="author" content="Tim Tomes">
        <meta name="description" content="Articles, information, and projects related to development and web application security.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway:400,300,600" type="text/css">
        <link rel="stylesheet" href="/static/css/normalize.css">
        <link rel="stylesheet" href="/static/css/skeleton.css">
        <link rel="stylesheet" href="/static/css/style.css">
        <link rel="stylesheet" href="/static/css/pygments.css">
        <link rel="shortcut icon" href="https://www.gravatar.com/avatar/0a6d9b1ad59ad436bf9d9d16b2a7133e.png?s=16" />
    </head>
    <body>
        <div class="container">
            <div class="row">
                <div class="four columns meta">
                    <ul>
                        <li><a href="/"><img src="https://www.gravatar.com/avatar/0a6d9b1ad59ad436bf9d9d16b2a7133e.png?s=128" class="avatar" /></a></li>
                                            <li><a href="https://bitbucket.org/lanmaster53" target="_blank"><img src="/static/images/meta/bitbucket.png" /></a></li>
                                            <li><a href="https://github.com/lanmaster53" target="_blank"><img src="/static/images/meta/github.png" /></a></li>
                                            <li><a href="https://twitter.com/lanmaster53" target="_blank"><img src="/static/images/meta/twitter.png" /></a></li>
                                            <li><a href="https://www.linkedin.com/in/lanmaster53" target="_blank"><img src="/static/images/meta/linkedin.png" /></a></li>
                                            <li><a href="https://www.youtube.com/user/lanmaster53" target="_blank"><img src="/static/images/meta/youtube.png" /></a></li>
                                        </ul>
                </div>
                <div class="eight columns nav">
                    <ul>
                        <li><a href="https://www.practisec.com/"><span style="font-weight: bold; color: #00b5ef;">Practi</span><span style="font-weight: bold; color: #1e1b1d;">Sec</span></a> | </li>
                                            <li><a href="/projects/">Projects</a> | </li>
                                            <li><a href="/archive/">Archive</a> | </li>
                                            <li><a href="/categories/">Categories</a> | </li>
                                            <li><a href="/about/">About</a></li>
                                        </ul>
                </div>
            </div>
            <!-- hr style="margin-top: 0;" -->
            <div class="row">
                <div class="twelve columns">
                    <h2>Cross-Site Trust Exploitation (XSTE)</h2>
<h5>Wednesday, May 21, 2014</h5>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="twelve columns">
                    <div class="content">
    <p>XSTE... Catchy title, right? truth be told, it's a fancy name that a collegue of mine and I gave to a <a href="https://www.owasp.org/index.php/Content_Spoofing">Content Spoofing</a> attack we conducted on a penetration test last week. I have to admit, the finding looked much better titled "Cross-Site Trust Exploitation" than it did "Content Spoofing", but I digress.</p>
<!-- READMORE -->

<p>For those unfamiliar with Content Spoofing, it is a flaw similar to Cross-Site Scripting (XSS) where a payload is placed into a user controlled input that is reflected back to the user by the application, but rather than than injecting script payloads, the attacker injects a payload that defaces the page. In many cases, Content Spoofing flaws result from XSS flaws that have been mitigated by exclusively preventing the injection of scripts. Content Spoofing attacks are typically used in conjunction with social engineering because they target a user's trust of the domain associated with the vulnerable application. Let me explain.</p>
<p>Let's say you come across a web page that looks something like this.</p>
<p><a href="/static/images/posts/xste_1.png"><img alt="" src="/static/images/posts/xste_1.png" /></a></p>
<p>When I see something like this, I immediately think XSS. The page has clearly reflected something we control back to us.</p>
<p><a href="/static/images/posts/xste_2.png"><img alt="" src="/static/images/posts/xste_2.png" /></a></p>
<p>If we attempt to leverage this reflective behavior to conduct an XSS attack, we'll see that the developer has mitigated XSS on this parameter.</p>
<ul>
<li>Payload</li>
</ul>
<div class="codehilite"><pre><span></span><code>https://172.21.9.71:8000/&lt;script&gt;alert(42)&lt;/script&gt;
</code></pre></div>

<ul>
<li>Result</li>
</ul>
<p><a href="/static/images/posts/xste_3.png"><img alt="" src="/static/images/posts/xste_3.png" /></a></p>
<p>In this case, HTML output encoding was used to mitigate XSS. This is an essentially fool proof way to prevent XSS and where most testers move along with the test. But there is still danger lurking here. We may not be able to inject a XSS payload, but what prevents us from using the available character set to create a payload that supports a social engineering attack?</p>
<ul>
<li>Payload</li>
</ul>
<div class="codehilite"><pre><span></span><code>https://172.21.9.71:8000/en-US/secure_login&#39;&#39; was not found \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ Security Alert!!! This Splunk Server Is Currently Under Attack. The Server&#39;s Secret Key May Be Compromised. Please Authenticate Through The Backup Proxy @172.22.22.199:8000 \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\ The path &#39;&#39;/en-US/secure_login
</code></pre></div>

<ul>
<li>Result</li>
</ul>
<p><a href="/static/images/posts/xste_4.png"><img alt="" src="/static/images/posts/xste_4.png" /></a></p>
<p>We've taken a seemingly mitigated XSS vulnerability and spoofed meaningful content to exploit it further, using this page in an attempt to exploit a victim's trust in the associated domain. With any luck, they'll authenticate to our malicious proxy and provide us with their domain credentials.</p>
</div>
<p>Like what you see? Join me for live training! See the <a href="https://www.practisec.com/training/">Training</a> page for more information.</p>
<hr>
<div class="comments">
    <h6>Please share your thoughts, comments, and suggestions via Twitter.</h6>
    <a href="http://twitter.com/share" class="twitter-share-button" data-count="none" data-via="">Tweet</a>
    <a href="http://twitter.com/lanmaster53" class="twitter-follow-button" data-show-count="false">Follow @lanmaster53</a>
    <script src="https://platform.twitter.com/widgets.js" type="text/javascript"></script>
</div>
                </div>
            </div>
            <hr>
            <div class="row">
                <div class="twelve columns">
                    <footer>
                        <p style="float: right;">
                            &copy; 2022 Tim Tomes
                        </p>
                    </footer>
                </div>
            </div>
        </div>
        <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-52269615-1', 'lanmaster53.com');
    ga('send', 'pageview');
</script>    </body>
</html>